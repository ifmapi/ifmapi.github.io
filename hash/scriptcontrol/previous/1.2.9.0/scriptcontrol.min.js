
//============================================================================

// Copyright (c) IFM Infomaster. All rights reserved.

//============================================================================

"use strict";function defineEvents(){for(var t,i={},n=0;n<arguments.length;n++){if(t=arguments[n],!Ifm.Type.isString(t))throw Ifm.Diagnostics.Errors.arg("name");createEventAccessors(i,t)}return i}function createEventAccessors(n,t){var i=new Ifm.Event;Object.defineProperty(n,t,{get:function(){return i},set:function(n){i.addHandler(n)}})}function inherits(n,t){if(!Ifm.Type.isFunction(n))throw Ifm.Diagnostics.Errors.func("ctorClass");if(!Ifm.Type.isFunction(t))throw Ifm.Diagnostics.Errors.func("ctorBase");return n.prototype=Object.create(t.prototype),n.prototype.constructor=n,t.prototype}function namespace(n,t){for(var r,f,i=window,e=n.split("."),u=0;u<e.length;u++)r=e[u],i[r]=i[r]||{},i=i[r];for(f in t)i[f]=t[f];return i}function query(n){var i=n||window.location.search,t={};return i.replace(/[?&#]([^=]+)=([^&]*)?/g,function(n,i,r){return i&&(t[i]=r||""),""}),t}var global,T0,dT,Ifm;if(window.onerror=function(n,t,i,r,u){if(window["ifm-disable-blue-screen"]!==!0){var f=n||"crash!",e=t+":"+i+":"+r,o=u&&u.stack?u.stack:u||"no stack info";setTimeout(function(){document.open();document.write('<!-- Copyright © IFM Infomaster. All rights reserved. --><!doctype html><html style="background-color:#03c;color:#fff;"><head>    <title>uh oh!<\/title>    <meta charset="utf-8"><\/head><body style="padding:8px;font:1em monospace;">    <pre style="font-size:4em;">:(<\/pre>    <pre style="font-size:1.5em;">'+f+'<\/pre>    <pre style="font-size:1em;">'+e+'<\/pre>    <pre style="font-size:1em;">-- stack --\n'+o+"<\/pre><\/body><\/html>");document.close()},1)}},global=global||window,Object.defineProperty?Object.defineProperty(global,"T0",{value:+new Date}):T0=+new Date,dT=function(){return new Date-T0},Function.getName=function(n){if(!Ifm.Type.isFunction(n))throw Ifm.Diagnostics.Errors.func("func");var t=/function\s+(\w+)/.exec(n);return t&&t.length===2?t[1]:(t=/(\w+)\s*=\s*function/.exec(n),t&&t.length===2)?t[1]:"anonymous function"},Function.prototype.toShortString=function(){var n=this.toString().replace(/[\r|\n]/g,"").replace(/[\s]+/g," ");return n.substr(0,n.indexOf("{")).trim()},Array.pushArray=function(n,t){if(!Ifm.Type.isArray(n))throw Ifm.Diagnostics.Errors.arg("array1");if(!Ifm.Type.isArray(t))throw Ifm.Diagnostics.Errors.arg("array2");return Array.prototype.push.apply(n,t)},!Array.prototype.find)try{Object.defineProperty(Array.prototype,"find",{enumerable:!1,value:function(n,t){if(!Ifm.Type.isFunction(n))throw Ifm.Diagnostics.Errors.func("func");for(var i=0,r=this.length;i<r;i++)if(i in this&&n.call(t,this[i],i,this))return this[i];return undefined}})}catch(e){}window.ArrayBuffer&&(ArrayBuffer.fromBytes=function(n){for(var i=n.length,r=new ArrayBuffer(i),u=new Uint8Array(r),t=0;t<i;t++)u[t]=n[t];return r},ArrayBuffer.prototype.getBytes=function(){for(var t=new Uint8Array(this),i=[],n=0,r=t.length;n<r;n++)i.push(t[n]);return i});Object.entries||(Object.entries=function(n){var i=[];for(var t in n)n.hasOwnProperty(t)&&i.push([t,n[t]]);return i});Object.keys||(Object.keys=function(n){var t=[];for(var i in n)n.hasOwnProperty(i)&&t.push(i);return t});Object.values||(Object.values=function(n){var t=[];for(var i in n)n.hasOwnProperty(i)&&t.push(n[i]);return t});String.format=function(n){if(!n||!Ifm.Type.isString(n))return n;var t=Array.prototype.slice.call(arguments,1);return n.replace(/{(\d+)}/g,function(n,i){return typeof t[i]!="undefined"?t[i]:""})};String.prototype.format=function(){var n=[this];return Array.prototype.push.apply(n,arguments),String.format.apply(null,n)};String.prototype.startsWith||(String.prototype.startsWith=function(n,t){return t=t||0,this.substr(t,n.length)===n});String.prototype.endsWith||(String.prototype.endsWith=function(n,t){t=t||this.length;var i=Math.max(t-n.length,0);return this.slice(i,t)===n});String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")});String.prototype.indexAfter=function(n){var t=this.indexOf(n);return t+(t<0?0:n.length)};String.prototype.lastIndexAfter=function(n){var t=this.lastIndexOf(n);return t+(t<0?0:n.length)};Date.now||(Date.now=function(){return+new Date});Date.prototype.toISOString||function(){function n(n){var t=String(n);return t.length===1&&(t="0"+t),t}Date.prototype.toISOString=function(){return this.getUTCFullYear()+"-"+n(this.getUTCMonth()+1)+"-"+n(this.getUTCDate())+"T"+n(this.getUTCHours())+":"+n(this.getUTCMinutes())+":"+n(this.getUTCSeconds())+"."+String((this.getUTCMilliseconds()/1e3).toFixed(3)).slice(2,5)+"Z"}}();Date.prototype.toISOLocaleDateString||(Date.prototype.toISOLocaleDateString=function(){var i=""+this.getFullYear(),n=""+(this.getMonth()+1),t=""+this.getDate();return n.length<2&&(n="0"+n),t.length<2&&(t="0"+t),i+"-"+n+"-"+t});Ifm=namespace("Ifm"),function(){Ifm.version="Ifm.js/1.0.88-3363";this.Enum={};this.Enum.getName=function(n,t){for(var r,u=Object.getOwnPropertyNames(n),i=0,f=u.length;i<f;i++)if(r=u[i],n[r]===t)return r;return""};this.Enum.getLength=function(n){return Object.getOwnPropertyNames(n).length};this.Type={};this.Type.getTypeName=function(n){var i=Object.prototype.toString.call(n).slice(8,-1),t;return i==="Object"&&(t=n&&n.constructor&&n.constructor.toString().match(/function\s+([^\s]{1,})\s*\(/),t)?t[1]:i};this.Type.isArray=function(n){return Object.prototype.toString.call(n)==="[object Array]"};this.Type.isLikeArray=function(n){return typeof n=="object"&&!Ifm.Type.isString(n)&&typeof n.length=="number"&&!n.propertyIsEnumerable("length")};this.Type.isFunction=function(n){return typeof n=="function"};this.Type.isNumber=function(n){return typeof n=="number"};this.Type.isString=function(n){return typeof n=="string"||n instanceof String};this.Event=function(){if(!(this instanceof Ifm.Event))throw Ifm.Diagnostics.Errors.ctor();var n=[];return{constructor:Ifm.Event,addHandler:function(t,i){Ifm.Type.isFunction(t)&&n.push({f:t,o:i||null})},hasHandlers:function(){return n.length>0},removeAllHandlers:function(){n.length=0},removeHandler:function(t){for(var i=n.length;i--;)n[i].f===t&&n.splice(i,1)},raise:function(){for(var i=n.length,t;i--;)t=n[i],t.f.apply(t.o,arguments)}}}}.call(Ifm);namespace("Ifm.Diagnostics"),function(){this.Debug={};this.Debug.onprint=new Ifm.Event;this.Debug.enabled=!1;this.Debug.popupAssertions=!1;this.Debug.assert=function(n,t){if(Ifm.Diagnostics.Debug.enabled){if(Ifm.Type.isString(n)){try{var i=new Function("return "+n);Ifm.Diagnostics.Debug.assert(i(),n+" "+t)}catch(r){Ifm.Diagnostics.Debug.fail("Invalid assert condition '"+n+"' : "+r.message)}return}n||Ifm.Diagnostics.Debug.fail(t)}};this.Debug.fail=function n(t){if(Ifm.Diagnostics.Debug.enabled){var i=arguments[1],u=arguments[2]||n;if(!i)try{throw new Error("Assertion failed");}catch(r){i=r.stack||"[Callstack not available]"}window.console&&console.error&&console.error(t,i);Ifm.Diagnostics.Debug.popupAssertions&&alert(t+"\n\n----Stack----\n\n"+i)}};this.Debug.clear=function(){if(Ifm.Diagnostics.Debug.enabled){window.console&&console.clear&&console.clear();var n=document.getElementById("consoleview");n&&(n.innerHTML="")}};this.Debug.print=function(n){var t,i;Ifm.Diagnostics.Debug.enabled&&(t=arguments.length>1?Array.prototype.slice.call(arguments).join(" "):n&&n.toString()||null,t!==null)&&(window.console&&console.log&&console.log(t),Ifm.Diagnostics.Debug.onprint.raise(t),i=document.getElementById("consoleview"),i&&(i.innerHTML+=t+"<br>",i.scrollTop=i.scrollHeight))};this.Debug.printf=function(){Ifm.Diagnostics.Debug.enabled&&Ifm.Diagnostics.Debug.print(String.format.apply(null,arguments))};this.Errors=function(){function t(n,t){return new Error(n+(t?": '"+t+"'":""))}var n={};return n.arg=function(n){return t("Invalid function argument",n)},n.argsno=function(n){return t("Invalid number of function arguments",n)},n.browser=function(){return t("Browser not supported")},n.ctor=function(n){return t("Invalid constructor call",n)},n.func=function(n){return t("Function argument expected",n)},n.miss=function(n){return t("Missing type or module",n)},n.notimpl=function(n){return t("Feature not implemented",n)},n.notsup=function(n){return t("Feature not supported",n)},n.op=function(n){return t("Invalid operation",n)},n}()}.call(Ifm.Diagnostics);namespace("Ifm.Net").WebSocket=function(){function i(n){switch(n){case"403":return": no destination for protocol";case"500":return": client-gateway protocol error";case"502":return": gateway-server protocol error";case"503":return": no destination reachable";default:return""}}var n={},t;return n.ErrorReasons={Failed:"Connection failed",Lost:"Connection lost",Refused:"Connection refused"},n.MessageType={BINARY:"Binary",OBJECT:"Object",TEXT:"Text"},n.isSupported=function(){return global&&global.Ifm&&global.WebSocket?!0:!1},n.create=function(r,u){var f,e,o;if(!n.isSupported())throw Ifm.Diagnostics.Errors.notsup("WebSocket");if(!Ifm.Type.isString(r))throw Ifm.Diagnostics.Errors.arg("url");return f={},f.events=defineEvents("connecting","open","closing","closed","error","receive"),f.id=function(){return t+=1}(),f.connect=function(){function s(){o||(console.debug("[Ifm.Net.WebSocket] %d [%s|%s] %s",t,r,u,"onopen"),o=!0,f.events.open.raise(f,{}))}if(!e||!(e.readyState<WebSocket.CLOSING)){f.events.connecting.raise(f,{});try{e=u?new WebSocket(r,u):new WebSocket(r)}catch(h){f.events.error.raise(f,{error:h});f.events.closed.raise(f,{clean:!1,reason:Ifm.Net.WebSocket.ErrorReasons.Failed});return}e.onmessage=function(e){var o,h;if(Ifm.Type.isString(e.data)){if(o=e.data,o.startsWith("#close")){var c=o.split("|"),l=c.length>1?c[1]:"0",a=l+i(l);console.debug("[Ifm.Net.WebSocket] %d [%s|%s] %s (%s)",t,r,u,"close notification",a);return}if(s(),o.startsWith("{")&&o.endsWith("}")){h=null;try{h=JSON.parse(o)}catch(v){}if(h!==null){f.events.receive.raise(f,{type:n.MessageType.OBJECT,message:h});return}}f.events.receive.raise(f,{type:n.MessageType.TEXT,message:o})}else s(),f.events.receive.raise(f,{type:n.MessageType.BINARY,message:e.data})};e.onclose=function(n){console.debug("[Ifm.Net.WebSocket] %d [%s|%s] %s (code: %d)",t,r,u,"onclose",n.code);f.events.closed.raise(f,{clean:n.wasClean,reason:n.wasClean?"":o?Ifm.Net.WebSocket.ErrorReasons.Lost:Ifm.Net.WebSocket.ErrorReasons.Refused});o=!1;e=null};e.onerror=function(n){f.events.error.raise(f,n)}}},f.close=function(){(console.debug("[Ifm.Net.WebSocket] %d [%s|%s] %s",t,r,u,"close"),e&&e.readyState!==WebSocket.CLOSED)&&(f.events.closing.raise(f,{}),e.close())},f.send=function(n){if(!e||e.readyState!==WebSocket.OPEN)throw Ifm.Diagnostics.Errors.op("WebSocket not open");e.send(n)},Object.defineProperties(f,{isOpen:{get:function(){return f.state===WebSocket.OPEN}},state:{get:function(){return e?e.readyState:WebSocket.CLOSED}}}),e=null,o=!1,f},t=0,n}();namespace("Ifm.Messaging"),function(n){n.FStringMessage={MessageHeaderV1:"*begin*",MessageTypeDelV1:"%%%",MessageFieldDelV1:"###",MessageFooterV1:"§end§",MessageHeaderV2:"|begin|",MessageTypeDelV2:"|%|",MessageFieldDelV2:"|#|",MessageFooterV2:"|end|",MinValidLength:16,ProtocolVersion:"V1"};n.FStringMessageReader=function(t){var i;if(!(this instanceof Ifm.Messaging.FStringMessageReader))throw Ifm.Diagnostics.Errors.ctor("Ifm.Messaging.FStringMessageReader");if(!t)throw Ifm.Diagnostics.Errors.arg("messageBuffer");if(this._message="",this._readingpos=0,Ifm.Type.isString(t))this._message=t;else throw new Error("FStringMessageReader() -> Unsupported message data format: "+typeof t);if(this._message.length<n.FStringMessage.MinValidLength)throw new Error("FStringMessageReader() -> Invalid message length: "+this._message.length);if(this._message.startsWith(n.FStringMessage.MessageHeaderV1)){if(i=this._message.match(/^\*begin\*([A-z0-9]*)%{3}/),i&&i.length==2)this.type=i[1];else throw new Error("FStringMessageReader() -> Invalid FStringMessage type format");if(i=this._message.match(/%{3}(.*)[\xA7|$]end[\xA7|$]/),i&&i.length==2)this.data=i[1].split(n.FStringMessage.MessageFieldDelV1);else throw new Error("FStringMessageReader() -> Invalid FStringMessage data format");}else if(this._message.startsWith(n.FStringMessage.MessageHeaderV2)){if(i=this._message.match(/^\x7Cbegin\x7C([A-z0-9]*)\x7C%\x7C/),i&&i.length==2)this.type=i[1];else throw new Error("FStringMessageReader() -> Invalid FStringMessage type format");if(i=this._message.match(/\x7C%\x7C(.*)[\x7C]end[\x7C]/),i&&i.length==2)this.data=i[1].split(n.FStringMessage.MessageFieldDelV2);else throw new Error("FStringMessageReader() -> Invalid FStringMessage data format");}else throw new Error("FStringMessageReader() -> Invalid FStringMessage signature");};n.FStringMessageWriter=function(t,i){if(!(this instanceof Ifm.Messaging.FStringMessageWriter))throw Ifm.Diagnostics.Errors.ctor("Ifm.Messaging.FStringMessageWriter");if(!Ifm.Type.isString(t))throw Ifm.Diagnostics.Errors.arg("type");this._dataAdded=!1;this.type=t;i==="V2"?(n.FStringMessage.protocolVersion=i,this._message=n.FStringMessage.MessageHeaderV2+t+n.FStringMessage.MessageTypeDelV2):(n.FStringMessage.protocolVersion="V1",this._message=n.FStringMessage.MessageHeaderV1+t+n.FStringMessage.MessageTypeDelV1)};n.FStringMessageWriter.prototype.add=function(t){if(t===undefined||t===null)throw Ifm.Diagnostics.Errors.arg("str");return n.FStringMessage.protocolVersion==="V1"?(this._dataAdded&&(this._message+=n.FStringMessage.MessageFieldDelV1),this._message+=t,this._dataAdded=!0):(this._dataAdded&&(this._message+=n.FStringMessage.MessageFieldDelV2),this._message+=t,this._dataAdded=!0),this};n.FStringMessageWriter.prototype.end=function(){return this._message+=n.FStringMessage.protocolVersion==="V1"?n.FStringMessage.MessageFooterV1:n.FStringMessage.MessageFooterV2,this};n.FStringMessageWriter.prototype.toString=function(){return this._message}}(Ifm.Messaging);namespace("Ifm.Messaging").FPropertyList=function(n){if(!(this instanceof Ifm.Messaging.FPropertyList))throw Ifm.Diagnostics.Errors.ctor();if(!n||!Ifm.Type.isString(n))throw Ifm.Diagnostics.Errors.arg("pliststr");n=n.trim();for(var t={},i=[],r,u=/{\s*([^\s{]*)\s*=\s*([^}]*)}/g;r=u.exec(n);)t[r[1]]=r[2],i.push(r[1]);this.events=defineEvents("changed");this.originalString=n;this.get=function(n){if(!n||!Ifm.Type.isString(n))throw Ifm.Diagnostics.Errors.arg("key");return t[n]};this.keys=function(){var n=[];for(var i in t)n.push(i);return n};this.remove=function(n){if(!n||!Ifm.Type.isString(n))throw Ifm.Diagnostics.Errors.arg("key");if(t.hasOwnProperty(n)){delete t[n];for(var r=i.length;r--;)i[r]===n&&(i.splice(r,1),this.events.changed.raise(this,{key:n,value:undefined}))}};this.set=function(n,r){if(!n||!Ifm.Type.isString(n))throw Ifm.Diagnostics.Errors.arg("key");r!==undefined&&(t.hasOwnProperty(n)||i.push(n),t[n]!==r&&(t[n]=r,this.events.changed.raise(this,{key:n,value:r})))};this.toString=function(){for(var r="{",n=0;n<i.length;n++)r+="{"+i[n]+" = "+t[i[n]]+"}";return r+"}"}},function(){var n=namespace("Ifm.ScriptControl");n.instance=function(){function f(n){try{e(n)}catch(t){console.error("Error processing message:",n,t)}}function e(i){var r=new Ifm.Messaging.FStringMessageReader(i),a,c,e,v,l,h,o,s,u,y,f;switch(r.type){case"20001":n.events.onabortcallreply.raise({campaign:r.data[0],callid:r.data[1],accepted:r.data[2]});break;case"20002":n.events.onalertingevent.raise({campaign:r.data[0],callid:r.data[1]});break;case"20003":n.events.onansweredevent.raise({campaign:r.data[0],callid:r.data[1]});break;case"20004":n.events.onassignmentrequest.raise({campaign:r.data[0],callid:r.data[1],calldata:r.data[2],recordingstate:r.data[3],recordingfilename:r.data[4]});break;case"20005":n.events.onrecordingcompletedevent.raise({callid:r.data[0],result:r.data[1]});break;case"20006":n.events.onrecordingmutedevent.raise({callid:r.data[0],txchannelmuted:r.data[1],rxchannelmuted:r.data[2]});break;case"20007":n.events.onrecordingstartedevent.raise({callid:r.data[0],recfilename:r.data[1]});break;case"20008":n.events.onbookedevent.raise({campaign:r.data[0]});break;case"20009":n.events.oncallfailureevent.raise({campaign:r.data[0],callid:r.data[1],reasoncode:r.data[2],protocolterminationcause:r.data[3],protocolterminationdescription:r.data[4],detectedcontentcode:r.data[5],detectedcontentdescription:r.data[5]});break;case"20010":n.events.oncalltransferinitiatedevent.raise({campaign:r.data[0],callid:r.data[1]});f=new Ifm.Messaging.FStringMessageWriter("10005",n.protocolVersion).end();t(f.toString());break;case"20011":n.events.onconnectionremovedevent.raise({campaign:r.data[0]});break;case"20012":n.events.ondeviceinfochangedevent.raise({lineid:r.data[0],deviceinfo:r.data[1]});break;case"20013":n.events.ondisplaynamechangedevent.raise({displayname:r.data[0]});break;case"20014":n.events.onphonebarclosedevent.raise({});break;case"20015":n.events.onloginreply.raise({accepted:r.data[0]});break;case"20016":n.events.onlogoutreply.raise({accepted:r.data[0]});break;case"20017":n.events.onnewcallreply.raise({campaign:r.data[0],accepted:r.data[1],callid:r.data[2]});break;case"20018":n.events.onothercallevent.raise({});break;case"20019":n.events.onpauseevent.raise({reasonid:r.data[0],reasondescription:r.data[1]});break;case"20020":n.events.onpausereply.raise({accepted:r.data[0],reasonid:r.data[1],reasondescription:r.data[2]});break;case"20021":n.events.onphonebarconnectionlostevent.raise({});break;case"20022":n.events.onpostcallworkevent.raise({campaign:r.data[0],callid:r.data[1]});break;case"20023":n.events.onreadyevent.raise({});break;case"20024":n.events.onreadyfordetachevent.raise({campaign:r.data[0],callid:r.data[1]});break;case"20025":n.events.onreadyreply.raise({accepted:r.data[0]});break;case"20026":n.events.onreadyfortransferevent.raise({campaign:r.data[0],callid:r.data[1]});break;case"20027":n.events.onretrievecallreply.raise({accepted:r.data[0]});break;case"20028":n.events.onrejectableassignmentrequest.raise({campaign:r.data[0],callid:r.data[1],calldata:r.data[2],recordingstate:r.data[3],recordingfilename:r.data[4]});break;case"20029":r.data.length>2?n.events.onterminatedevent.raise({campaign:r.data[0],callid:r.data[1],haspostcall:r.data[2]}):n.events.onterminatedevent.raise({campaign:r.data[0],callid:r.data[1]});break;case"20030":n.events.ontransferreply.raise({campaign:r.data[0],callid:r.data[1],accepted:r.data[2]});break;case"20031":n.events.onmaskeddigitreceivedevent.raise({callid:r.data[0]});break;case"20032":n.events.onmaskedpayloadreceivedevent.raise({callid:r.data[0],payload:r.data[1],result:r.data[2]});break;case"40008":n.events.onqueueinforeply.raise({campaign:r.data[0],callsnum:r.data[1],maxtime:r.data[2],avgtime:r.data[3]});break;case"40011":for(a=r.data[0],c=[],e=0;e<a;e++)c.push({firstname:r.data[1+e*5],lastname:r.data[2+e*5],state:r.data[3+e*5],time:r.data[4+e*5],campaign:r.data[5+e*5]});n.events.onagentslistreply.raise({agentsnum:r.data[0],agentslist:c});break;case"40012":for(console.debug("GetCampaignsList Reply received"),o=r.data[0],s=[],console.debug("GetCampaignsList Reply: count = "+o),u=0;u<o;u++)s.push({name:r.data[1+u*5],state:r.data[2+u*5],boundness:r.data[3+u*5],assigned:r.data[4+u*5],transfernotallowed:r.data[5+u*5]});n.events.oncampaignslistreply.raise({campaignsnum:r.data[0],campaignslist:s});break;case"40013":for(v=r.data[0],l=[],h=0;h<v;h++)l.push({code:r.data[1+h*2],description:r.data[2+h*2]});n.events.onpausereasonslistreply.raise({pausereasonsnum:r.data[0],pausereasonslist:l});break;case"40014":for(console.debug("GetCampaignsListEx Reply received"),o=r.data[0],s=[],console.debug("GetCampaignsListEx Reply: count = "+o),u=0;u<o;u++)s.push({name:r.data[1+u*6],state:r.data[2+u*6],boundness:r.data[3+u*6],assigned:r.data[4+u*6],transfernotallowed:r.data[5+u*6],flags:r.data[6+u*6]});n.events.oncampaignslistreply.raise({campaignsnum:r.data[0],campaignslist:s});break;case"40024":r.data.length>4?n.events.onagentdetailsreply.raise({firstname:r.data[0],lastname:r.data[1],extension:r.data[2],state:r.data[3],id:r.data[4]}):n.events.onagentdetailsreply.raise({firstname:r.data[0],lastname:r.data[1],extension:r.data[2],state:r.data[3]});break;case"40025":n.events.oncalldetailsreply.raise({callid:r.data[0],state:r.data[1],campaignname:r.data[2],calldata:r.data[3],isoutbound:r.data[4],audiorecordingstate:r.data[5],audiorecordingfilename:r.data[6],result:r.data[7]});break;case"99998":y=r.data[0];y==="V2"?(f=new Ifm.Messaging.FStringMessageWriter("99998",n.protocolVersion),f.add("V2").end(),t(f.toString()),n.protocolVersion="V2"):(f=new Ifm.Messaging.FStringMessageWriter("99998",n.protocolVersion),f.add("V1").end(),t(f.toString()),n.protocolVersion="V1");break;case"99999":n.events.oncommandexecutedevent.raise({commandcode:r.data[0],result:r.data[1]})}}function t(n){if(!i||!i.isOpen){console.warn("Invalid WebSocket state (undefined or closed)");return}if(!n||!n.length){console.warn("Invalid message (undefined or empty)");return}i.send(n)}var n={},r,i,u;return n.events=defineEvents("onconnected","ondisconnected","onabortcallreply","onalertingevent","onansweredevent","onassignmentrequest","onrecordingcompletedevent","onrecordingmutedevent","onrecordingstartedevent","onbookedevent","oncallfailureevent","oncalltransferinitiatedevent","onconnectionremovedevent","ondeviceinfochangedevent","ondisplaynamechangedevent","onphonebarclosedevent","onloginreply","onlogoutreply","onnewcallreply","onothercallevent","onpauseevent","onpausereply","onphonebarconnectionlostevent","onpostcallworkevent","onreadyevent","onreadyfordetachevent","onreadyreply","onreadyfortransferevent","onretrievecallreply","onrejectableassignmentrequest","onterminatedevent","ontransferreply","onmaskeddigitreceivedevent","onmaskedpayloadreceivedevent","onqueueinforeply","onagentslistreply","oncampaignslistreply","onpausereasonslistreply","onagentdetailsreply","oncalldetailsreply","oncommandexecutedevent"),n.protocolVersion="V1",n.convertEvenParameters=!1,Object.defineProperties(n,{domain:{get:function(){return u}},isConnected:{get:function(){return i&&i.isOpen}},version:{get:function(){return"1.2.9.0"}}}),n.connect=function(t){var u=r;t&&t.service&&(u=t.service);i&&i.close();i=Ifm.Net.WebSocket.create(u);i.events.closed=function(t,r){n.events.ondisconnected.raise(r);i=null};i.events.open=function(t,i){n.events.onconnected.raise(i)};i.events.receive=function(n,t){t.type===Ifm.Net.WebSocket.MessageType.TEXT&&f(t.message)};n.protocolVersion="V1";i.connect()},n.disconnect=function(){i&&i.close()},n.addconnection=function(i,r){if(!i)throw Ifm.Diagnostics.Errors.func("name");var u=new Ifm.Messaging.FStringMessageWriter("10001",n.protocolVersion);u.add(i).add(r||"").add("2").end();t(u.toString())},n.addcampaignlessconnection=function(i){var r=new Ifm.Messaging.FStringMessageWriter("10002",n.protocolVersion);r.add(i||"").add("2").end();t(r.toString())},n.removeconnection=function(i){if(!i)throw Ifm.Diagnostics.Errors.func("name");var r=new Ifm.Messaging.FStringMessageWriter("10003",n.protocolVersion);r.add(i).end();t(r.toString())},n.removecampaignlessconnection=function(){var i=new Ifm.Messaging.FStringMessageWriter("10004",n.protocolVersion).end();t(i.toString())},n.sethookstate=function(i){if(i!==0&&i!==1)throw Ifm.Diagnostics.Errors.func("hookstate");var r=new Ifm.Messaging.FStringMessageWriter("30001",n.protocolVersion);r.add(i).end();t(r.toString())},n.dump=function(i){var r=new Ifm.Messaging.FStringMessageWriter("30030",n.protocolVersion);r.add(i).end();t(r.toString())},n.login=function(i,r,u,f){var e=new Ifm.Messaging.FStringMessageWriter("30002",n.protocolVersion);e.add(i).add(r).add(u).add(f).end();t(e.toString())},n.loginwithtoken=function(i){var r=new Ifm.Messaging.FStringMessageWriter("30034",n.protocolVersion);r.add(i).end();t(r.toString())},n.logout=function(){var i=new Ifm.Messaging.FStringMessageWriter("30003",n.protocolVersion).end();t(i.toString())},n.makemanualcall=function(i,r,u){if(!i||i!==1&&i!==2)throw Ifm.Diagnostics.Errors.func("line");if(!r)throw Ifm.Diagnostics.Errors.func("number");if(u!==0&&u!==1)throw Ifm.Diagnostics.Errors.func("video");var f=new Ifm.Messaging.FStringMessageWriter("30004",n.protocolVersion);f.add(i).add(r).add(u).end();t(f.toString())},n.makecall=function(i,r,u,f){if(!i)throw Ifm.Diagnostics.Errors.func("number");if(!r)throw Ifm.Diagnostics.Errors.func("campaign");var e=new Ifm.Messaging.FStringMessageWriter("30005",n.protocolVersion);e.add(i).add(r).add(u||"").add(f||"").end();t(e.toString())},n.makedialercall=function(i,r){if(!i)throw Ifm.Diagnostics.Errors.func("campaign");var u=new Ifm.Messaging.FStringMessageWriter("30006",n.protocolVersion);u.add(i).add(r).end();t(u.toString())},n.pause=function(i){var r=new Ifm.Messaging.FStringMessageWriter("30007",n.protocolVersion);r.add(i||"0").end();t(r.toString())},n.getqueueinfo=function(i){var r=new Ifm.Messaging.FStringMessageWriter("30008",n.protocolVersion);r.add(i||"").end();t(r.toString())},n.playlocalfile=function(i){if(!i)throw Ifm.Diagnostics.Errors.func("filefullpath");var r=new Ifm.Messaging.FStringMessageWriter("30009",n.protocolVersion);r.add(i).end();t(r.toString())},n.stopplaylocalfile=function(){var i=new Ifm.Messaging.FStringMessageWriter("30010",n.protocolVersion).end();t(i.toString())},n.getagentslist=function(i,r){if(!i)throw Ifm.Diagnostics.Errors.func("mask");var u=new Ifm.Messaging.FStringMessageWriter("30011",n.protocolVersion);u.add(i).add(r||"").end();t(u.toString())},n.getcampaignslist=function(i,r,u){if(!i)throw Ifm.Diagnostics.Errors.func("mask");var f=new Ifm.Messaging.FStringMessageWriter("30012",n.protocolVersion);f.add(i).add(r||"0").add(u||"0").end();t(f.toString())},n.getpausereasonslist=function(){var i=new Ifm.Messaging.FStringMessageWriter("30013",n.protocolVersion).end();t(i.toString())},n.addcalldata=function(i,r){if(!i)throw Ifm.Diagnostics.Errors.func("name");if(!r)throw Ifm.Diagnostics.Errors.func("name");var u=new Ifm.Messaging.FStringMessageWriter("30014",n.protocolVersion);u.add(i).add(r).end();t(u.toString())},n.abortcall=function(){var i=new Ifm.Messaging.FStringMessageWriter("30015",n.protocolVersion).end();t(i.toString())},n.acceptrejectassignment=function(i){if(i!==1&&i!==0)throw Ifm.Diagnostics.Errors.func("accepted");var r=new Ifm.Messaging.FStringMessageWriter("30016",n.protocolVersion);r.add(i).end();t(r.toString())},n.retrievecall=function(){var i=new Ifm.Messaging.FStringMessageWriter("30017",n.protocolVersion).end();t(i.toString())},n.swapcall=function(){var i=new Ifm.Messaging.FStringMessageWriter("30018",n.protocolVersion).end();t(i.toString())},n.transfercall=function(i,r,u,f,e){if(!i)throw Ifm.Diagnostics.Errors.func("campaign");var o=new Ifm.Messaging.FStringMessageWriter("30019",n.protocolVersion);o.add(i).add(r||"").add(u||"");f==1||f==0?o.add(f):o.add("");e==0||e==1||e||2?o.add(e):o.add("");o.end();t(o.toString())},n.startaudiorecording=function(i,r){if(!i)throw Ifm.Diagnostics.Errors.func("filename");var u=new Ifm.Messaging.FStringMessageWriter("30020",n.protocolVersion);u.add(i).add(r||"").end();t(u.toString())},n.stopaudiorecording=function(){var i=new Ifm.Messaging.FStringMessageWriter("30021",n.protocolVersion).end();t(i.toString())},n.muteaudiorecording=function(i,r,u,f){if(i!==1&&i!==0)throw Ifm.Diagnostics.Errors.func("mutetx");if(r!==1&&r!==0)throw Ifm.Diagnostics.Errors.func("muterx");var e=new Ifm.Messaging.FStringMessageWriter("30022",n.protocolVersion);e.add(i).add(r).add(u||"").add(f||"").end();t(e.toString())},n.appendcuesheet=function(i){if(!i)throw Ifm.Diagnostics.Errors.func("cuesheet");var r=new Ifm.Messaging.FStringMessageWriter("30023",n.protocolVersion);r.add(i).end();t(r.toString())},n.getcurrentagetdetails=function(){var i=new Ifm.Messaging.FStringMessageWriter("30024",n.protocolVersion).end();t(i.toString())},n.getcurrentagentdetails=function(){var i=new Ifm.Messaging.FStringMessageWriter("30024",n.protocolVersion).end();t(i.toString())},n.getcurrentcalldetails=function(){var i=new Ifm.Messaging.FStringMessageWriter("30037",n.protocolVersion).end();t(i.toString())},n.ready=function(){var i=new Ifm.Messaging.FStringMessageWriter("30025",n.protocolVersion).end();t(i.toString())},n.conferencecall=function(i){if(i!==1&&i!==0)throw Ifm.Diagnostics.Errors.func("enabled");var r=new Ifm.Messaging.FStringMessageWriter("30026",n.protocolVersion);r.add(i).end();t(r.toString())},n.switchactiveline=function(){var i=new Ifm.Messaging.FStringMessageWriter("30027",n.protocolVersion).end();t(i.toString())},n.showcalltransferform=function(){var i=new Ifm.Messaging.FStringMessageWriter("30028",n.protocolVersion).end();t(i.toString())},n.setphonebarbuttonenabled=function(i,r){var u=new Ifm.Messaging.FStringMessageWriter("30029",n.protocolVersion);u.add(i).add(r).end();t(u.toString())},n.showinformationpopup=function(i,r){if(!i)throw Ifm.Diagnostics.Errors.func("messagetext");var u=new Ifm.Messaging.FStringMessageWriter("30031",n.protocolVersion);u.add(i).add(r).end();t(u.toString())},n.savecalldata=function(i){if(!i)throw Ifm.Diagnostics.Errors.func("calldata");var r=new Ifm.Messaging.FStringMessageWriter("30032",n.protocolVersion);r.add(i||"").end();t(r.toString())},n.setmutestate=function(i){if(i!==1&&i!==0)throw Ifm.Diagnostics.Errors.func("muted");var r=new Ifm.Messaging.FStringMessageWriter("30033",n.protocolVersion);r.add(i).end();t(r.toString())},n.agentloginwithtoken=function(i){if(!i)throw Ifm.Diagnostics.Errors.func("token");var r=new Ifm.Messaging.FStringMessageWriter("30034",n.protocolVersion);r.add(i).end();t(r.toString())},n.startdtmfmasking=function(i,r){var u=new Ifm.Messaging.FStringMessageWriter("30035",n.protocolVersion);u.add(i).add(r).end();t(u.toString())},n.stopdtmfmasking=function(){var i=new Ifm.Messaging.FStringMessageWriter("30036",n.protocolVersion).end();t(i.toString())},r="ws://localhost:22066/",u=null,n}()}();